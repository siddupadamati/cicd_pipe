name: Print Lines of Files in PR

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  print-file-lines:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout PR code
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Get list of changed files in this PR
        id: changed_files
        run: |
          git fetch origin ${{ github.base_ref }} --depth=1
          files=$(git diff --name-only origin/${{ github.base_ref }} HEAD)
          echo "files=$files" >> $GITHUB_OUTPUT

      - name: Print file names and their contents
        run: |
          echo "Changed files:"
          echo "${{ steps.changed_files.outputs.files }}"
          echo

          for file in ${{ steps.changed_files.outputs.files }}; do
            echo "=============================="
            echo "FILE: $file"
            echo "------------------------------"
            cat "$file"
            echo "=============================="
            echo
          done
